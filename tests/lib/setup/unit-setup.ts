/**
 * @file Глобальний файл налаштувань для unit-тестів.
 * @description Цей файл виконується перед запуском усіх unit-тестів.
 * Він відповідає за мокування глобальних залежностей, таких як змінні середовища,
 * модулі Next.js та об'єкт `console`, щоб забезпечити ізольоване та контрольоване середовище.
 */

import { vi } from "vitest";

// --- Мокування змінних середовища ---
// Встановлюємо фальшиві змінні середовища, щоб код, який від них залежить,
// не падав і використовував передбачувані значення.
process.env.NEXT_PUBLIC_SUPABASE_URL = "http://localhost:54321";
process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY = "test-anon-key";

// --- Мокування модулів Next.js ---
// Мокуємо модуль `next/headers`, оскільки він доступний тільки в середовищі виконання Next.js.
// Це запобігає помилкам під час виконання тестів у Node.js.
vi.mock("next/headers", () => ({
  cookies: vi.fn(() => ({
    getAll: vi.fn(() => []),
    setAll: vi.fn(),
    get: vi.fn(),
    set: vi.fn(),
  })),
}));

// --- Налаштування глобальних утиліт ---
// Приховуємо виведення помилок та попереджень у консоль під час тестів,
// щоб зберегти чистоту виводу результатів тестування.
global.console = {
  ...console,
  error: vi.fn(), // Приглушуємо console.error
  warn: vi.fn(), // Приглушуємо console.warn
};
