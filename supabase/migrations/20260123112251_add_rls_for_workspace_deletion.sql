-- ============================================================================
-- Migration: Додавання RLS політики для видалення воркспейсів
-- Reason: Дозволяє користувачам з роллю 'owner' видаляти свої воркспейси.
-- ============================================================================

-- Застосовуємо політику до таблиці 'workspaces'
-- Тільки користувач, який має роль 'owner' для даного воркспейсу, може його видалити.
CREATE POLICY "Allow owners to delete their workspace"
ON public.workspaces
FOR DELETE
USING (
  public.get_workspace_role(auth.uid(), id) = 'owner'
);
